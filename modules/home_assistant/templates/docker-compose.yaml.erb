version: '3'
services:
  home_assistant:
    image: homeassistant/home-assistant:<%= @home_assistant_version %>
    container_name: home_assistant
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "<%= @url %>"]
      interval: 30s
      timeout: 10s
      retries: 6
    ports:
      - 8123:8123
    volumes:
      - <%= @config_mount %>
    devices:
      - <%= @zwave_device %>:<%= @zwave_device %>:rwm
    network_mode: host
    environment:
      - TZ=America/Chicago
  xbox_smartglass_rest:
    image: openxbox/xbox-smartglass-rest:<%= @xbox_smartglass_version %>
    container_name: xbox_smartglass_rest
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "localhost:5557"]
      interval: 30s
      timeout: 10s
      retries: 6
    ports:
      - 5557:5557
    network_mode: host
    environment:
      - TZ=America/Chicago
